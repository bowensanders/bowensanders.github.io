<html>
  <head>
     <title>Introduction to Dapps. Simple MetaMask example.</title>
  </head>
  <body>
  <p>
    Lorem ipsum dolor sit amet, consectetur adipiscing elit. Quisque ut vestibulum diam. Nam varius eros eu dui molestie, et dignissim orci pellentesque. Praesent in ultrices magna. Fusce placerat eu nibh ut maximus. Nulla laoreet diam ac est congue, et varius ligula sollicitudin. Donec eu mi et sem hendrerit rhoncus vitae eu quam. Phasellus dictum congue erat. Etiam rutrum vel est eget mollis. Praesent volutpat turpis mi, id molestie sapien auctor consequat. Aenean laoreet elit ut lacus suscipit, sit amet fringilla orci dictum. Nam eget rhoncus neque. Vestibulum blandit eu ex a mattis.
  </p>
  <div id="meta-mask-required"></div>
  <fieldset>
    <label> Ether:
      <input type="text" id="amount"></input>
    </label>
    <button onclick="send()">Donate to the Author</button>
    <div id="response"></div>
  </fieldset>

  <script>
    // variable setup
    var smartWedContAddress;

    // get query variable
    function getQueryVariable(variable) {
        var query = window.location.search.substring(1);
        var vars = query.split('&');
        for (var i=0; i<vars.length; i++) {
            var pair = vars[i].split('=');
            if (decodeURIComponent(pair[0]) == variable) {
                return decodeURIComponent(pair[1]);
            }
        }
    } 

    // taken from smartwed page to get address of target contract
    function setWedContAddr() {
        smartWedContAddr = getQueryVariable('smartWedAddress');
        if (smartWedContAddr != null) {
            // alert(smartWedContAddr);
        } else {
            smartWedContAddr = '0xd09B6E3C8FB7E05e248197EC45c38cD338d66C1a';
        }
    }

    // MetaMask injects the web3 library for us.
    window.onload = function() {
      if (typeof web3 === 'undefined') {
        document.getElementById('meta-mask-required').innerHTML = 'You need <a href="https://metamask.io/">MetaMask</a> browser plugin to run this example'
      }
    }
    function send() {
      web3.eth.sendTransaction({
        from: web3.eth.coinbase,
        to: smartWedContAddress,
        value: web3.toWei(document.getElementById("amount").value, 'ether')
      }, function(error, result) {
        if (!error) {
          document.getElementById('response').innerHTML = 'Success: <a href="https://testnet.etherscan.io/tx/' + result + '"> View Transaction </a>'
        } else {
          document.getElementById('response').innerHTML = '<pre>' + error + '</pre>'
        }
      })
    }
  </script>
  </body>
</html>